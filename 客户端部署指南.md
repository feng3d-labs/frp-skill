# frp 客户端部署指南

将本地 HTTP 服务通过公网服务器 `li.feng3d.com` 暴露访问。

## 前提条件

- 服务端 `li.feng3d.com` 已部署并运行 frps（见《服务端部署指南》）
- 本地已运行 HTTP 服务（默认 `127.0.0.1:12345`）

## 部署步骤

### 1. 添加杀毒软件排除

Windows Defender 会将 frp 识别为威胁并自动删除，必须先添加排除。

以**管理员身份**打开 PowerShell，执行：

```powershell
Import-Module Defender
Add-MpExclusion -Path "你的frp部署目录路径"
```

> 如果使用其他杀毒软件（如火绒），需在对应软件中将部署目录加入信任区/白名单。

### 2. 下载 frp

从 GitHub 下载最新版本：https://github.com/fatedier/frp/releases

选择 `frp_*_windows_amd64.zip`（当前版本 v0.67.0）。

解压后将 `frpc.exe` 复制到部署目录。

也可以用 PowerShell 一键完成（需已添加排除）：

```powershell
$version = "0.67.0"
$dest = "C:\你的部署目录"
$url = "https://github.com/fatedier/frp/releases/download/v$version/frp_${version}_windows_amd64.zip"
$zip = Join-Path $dest "frp.zip"

Invoke-WebRequest -Uri $url -OutFile $zip
Add-Type -AssemblyName System.IO.Compression.FileSystem
$tmp = Join-Path $dest "frp_tmp"
[System.IO.Compression.ZipFile]::ExtractToDirectory($zip, $tmp)
Copy-Item (Join-Path $tmp "frp_${version}_windows_amd64\frpc.exe") $dest -Force
Remove-Item $zip -Force
Remove-Item $tmp -Recurse -Force
```

### 3. 配置 frpc.toml

在部署目录创建 `frpc.toml`：

```toml
serverAddr = "li.feng3d.com"
serverPort = 7000

[[proxies]]
name = "local-http"
type = "tcp"
localIP = "127.0.0.1"
localPort = 12345
remotePort = 12345
```

参数说明：
- `serverAddr` — 公网服务器地址
- `serverPort` — frps 通信端口
- `localIP` — 本地服务 IP（本机填 `127.0.0.1`）
- `localPort` — 本地服务端口
- `remotePort` — 公网暴露的端口

### 4. 启动客户端

```cmd
.\frpc.exe -c frpc.toml
```

看到 `start proxy success` 表示连接成功。

### 5. 验证

浏览器访问 `http://li.feng3d.com:12345`，应能看到本地 HTTP 服务内容。

## 常见问题

| 问题 | 解决方法 |
|------|----------|
| frpc.exe 下载后消失 | 杀毒软件拦截，需先添加排除再下载 |
| 连接服务器失败 | 检查服务端是否已启动，防火墙是否开放 7000 端口 |
| 访问公网端口无响应 | 检查服务端防火墙是否开放 remotePort（12345） |
| 本地服务无法访问 | 确认本地服务正在运行且 localIP/localPort 正确 |
